# 图形学实验 PA0: 光栅图形学 #

## 实现逻辑 ##

### 1. 直线段扫描转换 ###

- 首先判断特殊情况: **平行于坐标轴** 的线段直接画出, 避免导致后续的计算错误或更多的时空开销.
- 一般情况按照斜率 $k$, 判断两个标记:
  1. `neg_k`: $k<0?$ 判断斜率是否为负. 决定误差项越界时沿被动轴方向自增还是自减;
  2. `big_k`: $\lvert k \rvert > 1?$ 判断斜率绝对值是否大于1. 决定主动轴是 $x$ 还是 $y$;
- 采用整形的, 增量的Bresenham算法, **依两个标记所取决的方式**, 对主动轴逐点扫描, 期间增量的计算误差项, 并依误差项对被动轴自增/自减, 完成绘制.

#### 遇到问题及解决方案 ####

1. 曾试图对`k`的四种取值分别编写扫描转换, 但重复代码量太大, 遂利用两个标记, 在一个循环中支持四种一般线段的绘制.

### 2. 圆的扫描转换 ###

- 定义辅助方法`symdraw`, 进行八对称的画点.
- 按照增量的中点画圆法, 扫描 $x$ 轴, 过程中增量的计算误差项, 并依误差项令 $y$ 自减, 从而画出直角坐标系下 $\cfrac \pi 2 \geq \theta \geq \cfrac \pi 4$ 这一范围内的 $\cfrac 1 8$ 圆弧, 同时利用`symdraw`方法完成整个圆的绘制.

#### 遇到问题及解决方案 ####

1. 在扫描 $\cfrac 1 8$ 圆弧时, 曾使用 $x$, $y$ 的绝对坐标(而非相对圆心的坐标), 导致误差项的增量计算出错, 和`symdraw`中的复杂计算.
   后改进为使用相对圆心的坐标, 简化了误差项的计算以及`symdraw`中的计算.

### 3. 区域填充 ###

- 用BFS方法.
- 记录种子像素的颜色`oric`作为比较依据, 随后将种子像素染为目标颜色, 入队.
- 扩展与`oric`同色的四连通区域; 一个像素入队时立刻改为目标颜色, 以保证不会重复扫描.

## 参考资料 ##

- 课本2.1.3节 Bresenham算法部分
- 课本2.2.2节 中点画圆法部分
- 未与其他同学讨论或参考网上资料.

## TODOs ##

- 未有已发现而未能解决的的bug.
- 如有更多时间, 希望尝试实现交互式画图, 绘图结果导出格式文本等, 从而支持更高效更直观的调试或绘制.

## 对本次作业的建议 ##

- 文档标题是否应改为PA0, 而非PA3?

## 其他工作 ##

我尝试设计了一个新的测例`./doraemon.txt`, 共包含47次绘制, 示例结果如下.

![](./doraemon.bmp)
